= Installing on OpenShift 4

This guide describes how to install this component on OpenShift 4.

== Parameters for Keycloak

You need to disable some security context fields, as OpenShift sets those automatically.
Also, the sample below configures end-to-end encryption to Keycloak with https://docs.openshift.com/container-platform/4.9/security/certificates/service-serving-certificate.html[OpenShift service serving certificate].

[source,yaml,subs="attributes+"]
----
parameters:
  keycloak:
    tls:
      provider: openshift
    ingress:
      tls:
        termination: reencrypt
    extraVolumes:
      data:
        emptyDir: {}
    extraVolumeMounts:
      # Required as the OpenShift user can not create the data directory in the keycloak directory UID 1000/GID 0
      data:
        mountPath: /opt/keycloak/data
    helm_values:
      podSecurityContext: null
      securityContext: null
      dbchecker:
        securityContext: null
----

== Parameters for built-in Postgresql database

If you are using the built-in database provider (by default unless `keycloak.database.provider` is overridden) you also need to adjust the following parameters.

[source,yaml,subs="attributes+"]
----
parameters:
  keycloak:
    postgresql_helm_values:
      securityContext:
        enabled: false
      containerSecurityContext:
        enabled: false
      volumePermissions:
        securityContext:
          runAsUser: auto
          shmVolume:
            chmod:
              enabled: false
----
